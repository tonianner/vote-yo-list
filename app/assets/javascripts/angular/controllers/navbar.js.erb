var debug;
app.controller('NavBarCtrl', [
  '$scope', '$auth', '$location', 'UserFactory', '$rootScope', '$cookies',
    function($scope, $auth, $location, UserFactory, $rootScope, $cookies){
      console.log("NavBarCtrl")

      debug = $cookies;
      // check if user exist
      $auth.validateUser().then(function(user){
        UserFactory.identity = user;
        $scope.current_user = user;
      })

      // when user logged in successfully in login page
      $rootScope.$on('auth:login-success', function(ev, user) {
        UserFactory.identity = user;
        $scope.current_user = user;
      });

      // when user sign up successfully on signup page
      $rootScope.$on('auth:registration-email-success', function(ev, user) {
        UserFactory.identity = user;
        $scope.current_user = user;
      });

      $rootScope.$on('auth:logout-success', function(ev) {
        UserFactory.identity = null;
        $scope.current_user = null;
      });

      $scope.logout = function () {
        $auth.signOut().then(function(resp) {
          console.log(resp);
        }).catch(function(resp) {
          console.log(resp);
        });
      };
    }
])
