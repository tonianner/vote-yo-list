app.controller("EventCtrl", DashBoardCtrl)

DashBoardCtrl.$inject = ['EventFactory', '$scope', '$stateParams']

function DashBoardCtrl(EventFactory, $scope, $stateParams) {

  // EVENTS //
  var EventList = EventFactory;

  // New Event
  $scope.newEvent = {};

//
  $scope.selectedEvent = {}

  // Index
  $scope.allEvents = EventList.query();

  // Show one event and show todo tasks in the event
  $scope.selectEvent = function(id) {
    $scope.selectedEvent = EventList.get({id: id})

    // $scope.eventId = id
    // Show TASKS in selected event
    // $scope.allTasks = TaskFactory.query({eventId: $scope.eventId})
  };

  // Create event
  $scope.addEvent = function() {
    EventList.save($scope.newEvent, function(newEvent) {
      $scope.allEvents.push(newEvent);
      $scope.newEvent = {}
    });
  };

  // Update event >> Working but need to refresh
  $scope.updateEvent = function(data) {
    $scope.selectedEvent.title = data
    $scope.selectedEvent.$update({id: $scope.selectedEvent.id})
  }

  // Delete
  $scope.deleteEvent= function(event){
    EventList.delete({id: event.id});
    var index = $scope.allEvents.indexOf(event);
    $scope.allEvents.splice(index, 1);
  }



}