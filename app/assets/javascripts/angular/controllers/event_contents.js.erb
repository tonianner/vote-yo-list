// directive >> event_list.js.erb
// _angular_confit.js.erb >> .state >> url: '/events/:id'

app.controller("EventCtrl", DashBoardCtrl)

DashBoardCtrl.$inject = ['EventFactory', '$scope', '$stateParams']

function DashBoardCtrl(EventFactory, $scope, $stateParams) {
  console.log('Dash Board Ctrl')

  // EVENTS //
  var EventList = EventFactory;

  // Index >> Get All
  $scope.allEvents = EventList.query();

  // Blank new Event for Form >> Create Event
  $scope.newEvent = {};

  // Show selected content
  $scope.selectedEvent = EventList.get({id: $stateParams.id})

  // Create event
  $scope.addEvent = function() {
    EventList.save($scope.newEvent, function(newEvent) {
      $scope.allEvents.push(newEvent);
      $scope.newEvent = {}
    });
  };

  // Update event >> ** Working but need to refresh for event list **
  $scope.updateEvent = function(data) {
    $scope.selectedEvent.title = data
    $scope.selectedEvent.$update({id: $stateParams.id})
  }

  // Delete
  $scope.deleteEvent= function(event) {
    EventList.delete({id: event.id});
    var index = $scope.allEvents.indexOf(event);
    $scope.allEvents.splice(index, 1);
  }

}
